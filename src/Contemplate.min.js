   /*
    *  Simple light-weight javascript templating engine (part of php templating engine)
    *  @author: Nikos M.  http://nikos-web-development.netai.net/
    *  https://github.com/foo123/Contemplate
    *  version 0.4
    *
    *  @inspired by : Simple JavaScript Templating, John Resig - http://ejohn.org/ - MIT Licensed
    *  http://ejohn.org/blog/javascript-micro-templating/
    *
    */
(function(v){function w(a){var b,c=function(a){a=/\W*function\s+([\w\$]+)\s*\(/.exec(a);if(!a)return"(Anonymous)";return a[1]};if(!a||typeof a!=="object")return!1;this.php_js=this.php_js||{};this.php_js.ini=this.php_js.ini||{};b=this.php_js.ini["phpjs.objectsAsArrays"];return function(a){if(!a||typeof a!=="object"||typeof a.length!=="number")return!1;var b=a.length;a[a.length]="bogus";if(b!==a.length)return a.length-=1,!0;delete a[a.length];return!1}(a)||(!b||parseInt(b.local_value,10)!==0&&(!b.local_value.toLowerCase||
b.local_value.toLowerCase()!=="off"))&&Object.prototype.toString.call(a)==="[object Object]"&&c(a.constructor)==="Object"}function E(a){var b,c={};if(a&&typeof a==="object"&&a.change_key_case)return a.flip();for(b in a)a.hasOwnProperty(b)&&(c[a[b]]=b);return c}function F(a){var b=[],c="";if(a&&typeof a==="object"&&a.change_key_case)return a.values();for(c in a)b[b.length]=a[c];return b}function G(a,b){b=!b?" \\s\u00a0":(b+"").replace(/([\[\]\(\)\.\?\/\*\{\}\+\$\^\:])/g,"\\$1");return(a+"").replace(RegExp("["+
b+"]+$","g"),"")}function H(a,b){var c,e=0,d=0;a+="";b?(b+="",c=b.replace(/([\[\]\(\)\.\?\/\*\{\}\+\$\^\:])/g,"$1")):c=" \n\r\t\u000c\u000b\u00a0\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u200b\u2028\u2029\u3000";e=a.length;for(d=0;d<e;d++)if(c.indexOf(a.charAt(d))===-1){a=a.substring(d);break}e=a.length;for(d=e-1;d>=0;d--)if(c.indexOf(a.charAt(d))===-1){a=a.substring(0,d+1);break}return c.indexOf(a.charAt(0))===-1?a:""}function x(){return Math.floor((new Date).getTime()/1E3)}
function I(a,b){var c,e,d=/\\?([a-z])/gi,h,f=function(a,b){a=a.toString();return a.length<b?f("0"+a,b,"0"):a},s=["Sun","Mon","Tues","Wednes","Thurs","Fri","Satur","January","February","March","April","May","June","July","August","September","October","November","December"];h=function(a,b){return e[a]?e[a]():b};e={d:function(){return f(e.j(),2)},D:function(){return e.l().slice(0,3)},j:function(){return c.getDate()},l:function(){return s[e.w()]+"day"},N:function(){return e.w()||7},S:function(){var a=
e.j();return a<4|a>20&&(["st","nd","rd"][a%10-1]||"th")},w:function(){return c.getDay()},z:function(){var a=new Date(e.Y(),e.n()-1,e.j()),b=new Date(e.Y(),0,1);return Math.round((a-b)/864E5)},W:function(){var a=new Date(e.Y(),e.n()-1,e.j()-e.N()+3),b=new Date(a.getFullYear(),0,4);return f(1+Math.round((a-b)/864E5/7),2)},F:function(){return s[6+e.n()]},m:function(){return f(e.n(),2)},M:function(){return e.F().slice(0,3)},n:function(){return c.getMonth()+1},t:function(){return(new Date(e.Y(),e.n(),
0)).getDate()},L:function(){var a=e.Y();return a%4===0&a%100!==0|a%400===0},o:function(){var a=e.n(),b=e.W();return e.Y()+(a===12&&b<9?1:a===1&&b>9?-1:0)},Y:function(){return c.getFullYear()},y:function(){return e.Y().toString().slice(-2)},a:function(){return c.getHours()>11?"pm":"am"},A:function(){return e.a().toUpperCase()},B:function(){var a=c.getUTCHours()*3600,b=c.getUTCMinutes()*60,e=c.getUTCSeconds();return f(Math.floor((a+b+e+3600)/86.4)%1E3,3)},g:function(){return e.G()%12||12},G:function(){return c.getHours()},
h:function(){return f(e.g(),2)},H:function(){return f(e.G(),2)},i:function(){return f(c.getMinutes(),2)},s:function(){return f(c.getSeconds(),2)},u:function(){return f(c.getMilliseconds()*1E3,6)},e:function(){throw"Not supported (see source code of date() for timezone on how to add support)";},I:function(){var a=new Date(e.Y(),0),b=Date.UTC(e.Y(),0),c=new Date(e.Y(),6),d=Date.UTC(e.Y(),6);return a-b!==c-d?1:0},O:function(){var a=c.getTimezoneOffset(),b=Math.abs(a);return(a>0?"-":"+")+f(Math.floor(b/
60)*100+b%60,4)},P:function(){var a=e.O();return a.substr(0,3)+":"+a.substr(3,2)},T:function(){return"UTC"},Z:function(){return-c.getTimezoneOffset()*60},c:function(){return"Y-m-d\\TH:i:sP".replace(d,h)},r:function(){return"D, d M Y H:i:s O".replace(d,h)},U:function(){return c/1E3|0}};this.date=function(a,b){c=b===void 0?new Date:b instanceof Date?new Date(b):new Date(b*1E3);return a.replace(d,h)};return this.date(a,b)}var d,y=0,z={},n={},A={},q={},B="<%",o="%>",r="' + \"\\n\" + '",t=0,C=0,u=0,J=
["if","elseif","else","endif","for","elsefor","endfor","include","template","htmlselect","htmltable"],D=["count","concat","ltrim","rtrim","trim","sprintf","now","date","ldate","q","dq","l","s","n","f"],g={functions:null,controlConstructs:null,forExpr:null,quotes:null,specials:null,replacements:null},K=function(a,b){var c=null;this.id=null;if(a)this.id=a,c=b;this.setId=function(a){if(a)this.id=a;return this};this.render=function(a){if(c)return c(a);return""}};d={IS_NODEJS:!1,NFS:null,ENC:"utf8",CACHE_TO_DISK_NONE:0,
CACHE_TO_DISK_AUTOUPDATE:2,CACHE_TO_DISK_NOUPDATE:4,init:function(){g.controlConstructs=RegExp("\\t\\s*%("+J.join("|")+")\\b\\s*\\((.*)\\)","g");g.forExpr=/^\s*\$([a-z0-9_]+?)\s* as \s*\$([a-z0-9_]+?)\s*=>\s*\$([a-z0-9_]+)\s*$/i;g.quotes=/'/g;g.specials=/[\r\t]/g;g.replacements=RegExp("\\t\\s*(.*?)\\s*"+o,"g");D.length&&(g.functions=RegExp("%("+D.join("|")+")\\b","g"))},setLocaleStrings:function(a){q=d.merge(q,a)},setTemplateSeparators:function(a,b){a&&(B=a);b&&(o=b);b&&(g.replacements=RegExp("\\t\\s*(.*?)\\s*"+
o,"g"))},setPreserveLines:function(a){"undefined"==typeof a&&(a=!0);r=a?"' + \"\\n\" + '":""},isNodeJs:function(a,b){d.IS_NODEJS=a;d.NFS=a?b||require("fs"):null},setCacheDir:function(a){$__cacheDir=G(a,"/")+"/"},setCacheMode:function(a){y=d.IS_NODEJS?a:d.CACHE_TO_DISK_NONE},add:function(a){n=d.merge(n,a)},tpl:function(a,b){z[a]||(z[a]=d.getCachedTemplate(a));var c=z[a];return b?c.render(b):c},t_if:function(a){C++;return"'; if ("+a+") { "},t_elseif:function(a){return"'; } else if ("+a+") { "},t_else:function(){return"'; } else { "},
t_elsefor:function(){u--;return"'; } } } else { "},t_endif:function(){C--;return"'; } "},t_for:function(a){t++;u++;var a=a.match(g.forExpr),b="$"+a[1],c="$"+a[2];return"'; if ("+b+" && Object.keys("+b+").length) { for (var "+c+" in "+b+") { if (Contemplate.hasOwn("+b+", "+c+")) { var "+("$"+a[3])+"="+b+"["+c+"]; "},t_endfor:function(){if(u==t)return t--,u--,"'; } } } ";t--;return"'; } "},t_include:function(a){A[a]||(A[a]=" "+d.parse(d.getTemplateContents(a))+"'; ");return A[a]},t_template:function(a){var a=
a.split(","),b=H(a.shift()),a=a.join(",").split(r).join("").split("=>").join(":");return"'+ Contemplate.tpl(\""+b+'", '+a+"); "},t_table:function(a){return"'+ Contemplate.htmltable("+a.split(r).join("").split("=>").join(":")+"); "},t_select:function(a){return"'+ Contemplate.htmlselect("+a.split(r).join("").split("=>").join(":")+"); "},count:function(a,b){var c,e=0;if(a===null||typeof a==="undefined")return 0;else if(a.constructor!==Array&&a.constructor!==Object)return 1;b==="COUNT_RECURSIVE"&&(b=
1);b!=1&&(b=0);for(c in a)if(a.hasOwnProperty(c)&&(e++,b==1&&a[c]&&(a[c].constructor===Array||a[c].constructor===Object)))e+=this.count(a[c],1);return e},q:function(a){return"'"+a+"'"},dq:function(a){return'"'+a+'"'},s:function(a){return String(a)},n:function(a){return parseInt(a,10)},f:function(a){return parseFloat(a,10)},concat:function(){return Array.prototype.slice.call(arguments).join("")},trim:H,ltrim:function(a,b){b=!b?" \\s\u00a0":(b+"").replace(/([\[\]\(\)\.\?\/\*\{\}\+\$\^\:])/g,"$1");return(a+
"").replace(RegExp("^["+b+"]+","g"),"")},rtrim:G,sprintf:function(){var a=arguments,b=0,c=function(a,b,c,e){c||(c=" ");b=a.length>=b?"":Array(1+b-a.length>>>0).join(c);return e?a+b:b+a},e=function(a,b,e,d,j,k){var l=d-a.length;l>0&&(a=e||!j?c(a,d,k,e):a.slice(0,b.length)+c("",l,"0",!0)+a.slice(b.length));return a},d=function(a,b,d,j,m,k,l){a>>>=0;d=d&&a&&{2:"0b",8:"0",16:"0x"}[b]||"";a=d+c(a.toString(b),k||0,"0",!1);return e(a,d,j,m,l)};return a[b++].replace(/%%|%(\d+\$)?([-+\'#0 ]*)(\*\d+\$|\*|\d+)?(\.(\*\d+\$|\*|\d+))?([scboxXuideEfFgG])/g,
function(h,f,s,i,m,k,l){var g,n;if(h=="%%")return"%";var p=!1;n="";var o=m=!1;g=" ";for(var r=s.length,q=0;s&&q<r;q++)switch(s.charAt(q)){case " ":n=" ";break;case "+":n="+";break;case "-":p=!0;break;case "'":g=s.charAt(q+1);break;case "0":m=!0;break;case "#":o=!0}i=i?i=="*"?+a[b++]:i.charAt(0)=="*"?+a[i.slice(1,-1)]:+i:0;i<0&&(i=-i,p=!0);if(!isFinite(i))throw Error("sprintf: (minimum-)width must be finite");k=k?k=="*"?+a[b++]:k.charAt(0)=="*"?+a[k.slice(1,-1)]:+k:"fFeE".indexOf(l)>-1?6:l=="d"?0:
void 0;f=f?a[f.slice(0,-1)]:a[b++];switch(l){case "s":return l=String(f),k!=null&&(l=l.slice(0,k)),e(l,"",p,i,m,g);case "c":return l=String.fromCharCode(+f),k!=null&&(l=l.slice(0,k)),e(l,"",p,i,m,void 0);case "b":return d(f,2,o,p,i,k,m);case "o":return d(f,8,o,p,i,k,m);case "x":return d(f,16,o,p,i,k,m);case "X":return d(f,16,o,p,i,k,m).toUpperCase();case "u":return d(f,10,o,p,i,k,m);case "i":case "d":return g=+f||0,g=Math.round(g-g%1),h=g<0?"-":n,f=h+c(String(Math.abs(g)),k,"0",!1),e(f,h,p,i,m);case "e":case "E":case "f":case "F":case "g":case "G":return g=
+f,h=g<0?"-":n,n=["toExponential","toFixed","toPrecision"]["efg".indexOf(l.toLowerCase())],l=["toString","toUpperCase"]["eEfFgG".indexOf(l)%2],f=h+Math.abs(g)[n](k),e(f,h,p,i,m)[l]();default:return h}})},now:function(){return x()},date:function(a,b){b||(b=x());return I(a,b)},ldate:function(a,b){b||(b=x());for(var c=q,d=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sun","Mon","Tues","Wednes","Thurs","Fri","Satur","January","February","March","April","May","June","July","August",
"September","October","November","December","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],j=["AM","PM","am","PM"],h=I(a,b),f=0,g=d.length;f<g;f++)c[d[f]]&&(h=h.replace(d[f],c[d[f]]));f=0;for(g=j.length;f<g;f++)c[j[f]]&&(h=h.replace(j[f],c[j[f]]));return h},locale:function(a){return q[a]?q[a]:a},l:function(a){return d.locale(a)},htmltable:function(a,b){var b=b||{},c="",e="",j="",h="",f,e=[],g,i,m,j=!1,c="<table";b.id&&(c+=" id='"+b.id+"'");b["class"]&&(c+=" class='"+b["class"]+
"'");b.style&&(c+=" style='"+b.style+"'");if(b.data)for(f in b.data)d.hasOwn(b.data,f)&&(c+=" data-"+f+"='"+b.data[f]+"'");c+=">";e="";if(b.header||b.footer){h=[];e="";if(a&&typeof a==="object"&&a.change_key_case)h=a.keys(void 0,void 0);else for(e in a)a.hasOwnProperty(e)&&(h[h.length]=e);e="<td>"+h.join("</td><td>")+"</td>"}j="";b.header&&(j="<thead><tr>"+e+"</tr></thead>");h="";b.footer&&(h="<tfoot><tr>"+e+"</tr></tfoot>");c+=j;e=[];j=F(a);for(g in j)if(d.hasOwn(j,g)){f=j[g];w(f)||(f=[f]);m=F(f);
i=0;for(f=m.length;i<f;i++)e[i]||(e[i]=Array(f)),e[i][g]=m[i]}i=b.odd?b.odd:"odd";m=b.even?b.even:"even";j=!1;g=0;for(f=e.length;g<f;g++)c+=j?"<tr class='"+i+"'><td>"+e[g].join("</td><td>")+"</td></tr>":"<tr class='"+m+"'><td>"+e[g].join("</td><td>")+"</td></tr>",j=!j;delete null;c+=h;c+="</table>";return c},htmlselect:function(a,b){var b=b||{},c="",e,g,h,f,c="<select";b.multiple&&(c+=" multiple");b.disabled&&(c+=" disabled='disabled'");b.name&&(c+=" name='"+b.name+"'");b.id&&(c+=" id='"+b.id+"'");
b["class"]&&(c+=" class='"+b["class"]+"'");b.style&&(c+=" style='"+b.style+"'");if(b.data)for(e in b.data)d.hasOwn(b.data,e)&&(c+=" data-"+e+"='"+b.data[e]+"'");c+=">";b.selected?(w(b.selected)||(b.selected=[b.selected]),b.selected=E(b.selected)):b.selected={};if(b.optgroups)w(b.optgroups)||(b.optgroups=[b.optgroups]),b.optgroups=E(b.optgroups);d.log(b.selected);for(e in a)if(d.hasOwn(a,e))if(h=a[e],b.optgroups&&b.optgroups[e]){c+="<optgroup label='"+e+"'>";for(g in h)d.hasOwn(h,g)&&(f=h[g],b.use_key?
f=g:b.use_value&&(g=f),c+=d.hasOwn(b.selected,g)?"<option value='"+g+"' selected='selected'>"+f+"</option>":"<option value='"+g+"'>"+f+"</option>");c+="</optgroup>"}else b.use_key?h=e:b.use_value&&(e=h),c+=b.selected[e]?"<option value='"+e+"' selected='selected'>"+h+"</option>":"<option value='"+e+"'>"+h+"</option>";c+="</select>";return c},doControlConstruct:function(a){if(a[1])switch(a[1]){case "if":return d.t_if(a[2]);case "elseif":return d.t_elseif(a[2]);case "else":return d.t_else(a[2]);case "endif":return d.t_endif(a[2]);
case "for":return d.t_for(a[2]);case "elsefor":return d.t_elsefor(a[2]);case "endfor":return d.t_endfor(a[2]);case "template":return d.t_template(a[2]);case "embed":case "include":return d.t_include(a[2]);case "htmltable":return d.t_table(a[2]);case "htmlselect":return d.t_select(a[2])}return a[0]},parseControlConstructs:function(a){a=a.split(o).join("\n");a=a.replace(g.controlConstructs,function(a,c,e){return d.doControlConstruct([a,c,e])});return a=a.split("\n").join(o)},parse:function(a){return D.length?
d.parseControlConstructs(a.replace(g.specials," ").split(B).join("\t").replace(g.quotes,"\\'").split("\n").join(r)).replace(g.functions,"Contemplate.$1").replace(g.replacements,"' + ( $1 ) + '").split("\t").join("'; ").split(o).join(" $__p__ += '"):d.parseControlConstructs(a.replace(g.specials," ").split(B).join("\t").replace(g.quotes,"\\'").split("\n").join(r)).replace(g.replacements,"' + ( $1 ) + '").split("\t").join("'; ").split(o).join(" $__p__ += '")},getCachedTemplateName:function(a){return $__cacheDir+
a.replace(/[ -]/,"_")+".tpl.js"},getCachedTemplateClass:function(a){return"Contemplate_"+a.replace(/[ -]/,"_")+"_Cached"},getTemplateContents:function(a){if(n[a]){if(d.IS_NODEJS&&d.NFS)a=d.NFS.readFileSync(n[a],d.ENC);else if(-1!==n[a].indexOf("/")){var a=n[a],b;b=v.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");b.open("GET",a,!1);b.send(void 0);a=b.status===200?b.responseText:""}else a=v.document.getElementById(n[a]).innerHTML;return a}return""},createTemplateRenderFunction:function(a){d.reset();
a="for (var __n__ in $__o__) { if (Contemplate.hasOwn($__o__, __n__)) { $__o__['$'+__n__]=$__o__[__n__]; delete $__o__[__n__];} } var $__p__ = ''; with($__o__) { $__p__ += '"+d.parse(d.getTemplateContents(a))+"'; } return $__p__;";return new Function("$__o__",a)},createCachedTemplate:function(a,b,c){d.reset();a="(function(root) { \n/* Contemplate cached template '"+a+"' */ \nfunction "+c+"($id) { this.id=$id; }; "+c+".prototype.setId=function($id) { if ($id) {this.id=$id;} return this; }; "+c+".prototype.render=function($__o__) { for (var __n__ in $__o__) { if (Contemplate.hasOwn($__o__, __n__)) { $__o__['$'+__n__]=$__o__[__n__]; delete $__o__[__n__];} } var $__p__ = ''; with($__o__) { $__p__ += '"+
d.parse(d.getTemplateContents(a))+"'; } return $__p__; }; if ('undefined' != typeof (module) && module.exports) {module.exports="+c+";} else if (typeof (exports) != 'undefined') {exports="+c+";}  else {root."+c+"="+c+";} })(this);";return d.setCachedTemplate(b,a)},getCachedTemplate:function(a){if(!d.IS_NODEJS)y=d.CACHE_TO_DISK_NONE;switch(y){case d.CACHE_TO_DISK_NOUPDATE:var b=d.getCachedTemplateName(a),c=d.getCachedTemplateClass(a);d.NFS.existsSync(b)||d.createCachedTemplate(a,b,c);if(d.NFS.existsSync(b))return b=
require(b),$tpl=new b,$tpl.setId(a),$tpl;break;case d.CACHE_TO_DISK_AUTOUPDATE:b=d.getCachedTemplateName(a);c=d.getCachedTemplateClass(a);if(d.NFS.existsSync(b)){var e=d.NFS.statSync(b),g=d.NFS.statSync(n[a]);e.mtime.getTime()<=g.mtime.getTime()&&d.createCachedTemplate(a,b,c)}else d.createCachedTemplate(a,b,c);if(d.NFS.existsSync(b))return b=require(b),$tpl=new b,$tpl.setId(a),$tpl;break;default:return new K(a,d.createTemplateRenderFunction(a))}return null},setCachedTemplate:function(a,b){return d.NFS.writeFileSync(a,
b,d.ENC)},reset:function(){u=C=t=0},merge:function(){var a=Array.prototype.slice.call(arguments);if(!(a.length<1)){for(var b=a.shift(),c=0,e=a.length;c<e;c++){var g=a[c];if(g)for(var h in g)d.hasOwn(g,h)&&(b[h]=g[h])}return b}},isArray:function(a){return Object.prototype.toString.call(a)==="[object Array]"},hasOwn:function(a,b){return a&&Object.prototype.hasOwnProperty.call(a,b)},log:function(a){"undefined"!=typeof console&&v.console.log&&console.log(a)}};d.init();"undefined"!=typeof module&&module.exports?
module.exports=d:"undefined"!=typeof exports?exports=d:v.Contemplate=d;if("undefined"!=typeof global)global.Contemplate=d})(this);
